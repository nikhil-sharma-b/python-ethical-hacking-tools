#! /bin/usr/env python3

# Author: Nikhil Sharma B
# Created Date: 17-10-2020
# Last Updated: 24-10-2020
# Operating System: Linux, Windows, Mac
# Description: Looks for vulnerabilities in a website
# Does not seem to work -> the program is not extracting any forms from the links.
# try to find a solution or build a new vuln scanner in a different manner.

# Import the necessary libraries
import scanner

target_url = "http://172.17.0.3/dvwa/"
links_to_ignore = ["http://172.17.0.3/dvwa/logout.php"]

data_dict = {"username": "admin", "password": "password", "Login": "submit"}

vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
vuln_scanner.session.post("http://172.17.0.3/dvwa/login.php", data=data_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()